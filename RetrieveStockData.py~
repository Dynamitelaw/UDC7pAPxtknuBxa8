import urllib
import io

begin = [1,1,2010]
end = [1,1,2015]

base_url = "http://ichart.finance.yahoo.com/table.csv?s="
def make_url(ticker_symbol,begin,end):
	#+'&a='+str(begin[0])+'&b='+str(begin[1])+'&c='+str(begin[2])+'&d='+str(end[0])+'&e='+str(end[1])+'&f='+str(end[2])+'&g=d&ignore=.csv'
    return base_url + ticker_symbol

output_path = "Data/StockData"
def make_filename(ticker_symbol):
    return output_path + "/" + ticker_symbol + ".csv"

def pull_historical_data(ticker_symbol):
    try:
        urllib.urlretrieve(make_url(ticker_symbol,begin,end), make_filename(ticker_symbol))
    except urllib.ContentTooShortError as e:
        outfile = open(make_filename(ticker_symbol, directory), "w")
        outfile.write(e.content)
        outfile.close()

tickerFile = open('Data/ListOfTickerSymbols.csv','r')

for line in tickerFile:
	pull_historical_data(line)
	print(make_url(line,begin,end))
